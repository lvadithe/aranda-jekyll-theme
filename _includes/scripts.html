<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/html2canvas.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/jspdf.umd.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/main.js" type="module"></script>
<script src="{{ site.baseurl }}/assets/js/libs/iframeResizer.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/resize.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/handleCopyClick.js"></script>
<script>
    // Función para traducir el contenido de elementos con la clase especificada
    async function translateText() {
        const subscriptionKey = "faf48684aab84958aa0ad9bea172126a";
        const endpoint = "https://api.cognitive.microsofttranslator.com/";
        const version = "3.0";

        // Clase de elementos a traducir
        const elementClass = "translatedContent";

        // Obtener el idioma seleccionado del selector
        const selectedLanguage = document.getElementById("language").value;

        console.log("Idioma seleccionado:", selectedLanguage);
        try {
            // Obtener una lista de elementos con la clase especificada
            const elements = document.getElementsByClassName(elementClass);

            // Iterar sobre los elementos y traducir su contenido
            for (const contentElement of elements) {
                const originalHTML = contentElement.outerHTML; // Cambio aquí
                console.log("HTML original:", originalHTML);

                // Traducir el HTML completo
                const response = await fetch(
                    `${endpoint}/translate?api-version=${version}&to=${selectedLanguage}`,
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "Ocp-Apim-Subscription-Key": subscriptionKey,
                        },
                        body: JSON.stringify([{ text: originalHTML }]),
                    }
                );

                if (!response.ok) {
                    throw new Error("Error en la solicitud de traducción");
                }

                const result = await response.json();
                const translatedHTML = result[0].translations[0].text;

                // Crear un nuevo elemento con el HTML traducido
                const newElement = document.createElement("div");
                newElement.innerHTML = translatedHTML;

                // Reemplazar el contenido del elemento original con el nuevo
                contentElement.parentNode.replaceChild(
                    newElement.firstChild,
                    contentElement
                );

                console.log("HTML traducido:", translatedHTML);
            }
        } catch (error) {
            console.error("Error:", error.message);
        }

        // Cerrar el selector de idioma
        closeLanguageSelector();
    }

    function closeLanguageSelector() {
        var languageSelector = document.getElementById("languageSelector");
        var languageDropdown = document.getElementById("language");

        languageDropdown.style.display = "none";
        languageSelector.removeEventListener("click", closeLanguageSelector);
    }
</script>
