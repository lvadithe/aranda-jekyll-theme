<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/html2canvas.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/jspdf.umd.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/main.js" type="module"></script>
<script src="{{ site.baseurl }}/assets/js/libs/iframeResizer.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/resize.js"></script>
<script src="{{ site.baseurl }}/assets/js/modules/handleCopyClick.js"></script>

<script>
    // Función para traducir el contenido del elemento con id "translatedContent"
    async function translateText() {
        const subscriptionKey = "faf48684aab84958aa0ad9bea172126a";
        const endpoint = "https://api.cognitive.microsofttranslator.com/";
        const version = "3.0";

        // Obtener el contenido actual del elemento
        const contentElement = document.getElementById("translatedContent");
        const textToTranslate = contentElement.innerHTML;

        // Obtener el idioma seleccionado del selector
        const selectedLanguage = document.getElementById("language").value;

        console.log("Texto original:", textToTranslate);
        console.log("Idioma seleccionado:", selectedLanguage);
        try {
            const response = await fetch(
                `${endpoint}/translate?api-version=${version}&to=${selectedLanguage}`,
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Ocp-Apim-Subscription-Key": subscriptionKey,
                    },
                    body: JSON.stringify([{ text: textToTranslate }]),
                }
            );

            if (!response.ok) {
                throw new Error("Error en la solicitud de traducción");
            }

            const result = await response.json();
            console.log("Resultado de la traducción:", result);

            // Actualizar el contenido del elemento con la traducción
            contentElement.innerHTML = result[0].translations[0].text;

            console.log("Texto traducido:", result[0].translations[0].text);
        } catch (error) {
            console.error("Error:", error.message);
        }
    }
</script>
<script>
    async function translateHTML() {
        const subscriptionKey = "faf48684aab84958aa0ad9bea172126a";
        const endpoint = "https://api.cognitive.microsofttranslator.com/";
        const version = "3.0";

        // Obtener el idioma seleccionado del selector
        const selectedLanguage = document.getElementById("language").value;

        console.log("Idioma seleccionado:", selectedLanguage);
        console.log("Idioma seleccionado:", selectedLanguage);
        try {
            // Obtén el contenido HTML de la etiqueta
            const contentElement = document.getElementById("translatedContent");
            const htmlContent = contentElement.innerHTML;

            const response = await fetch(
                `${endpoint}/translate?api-version=${version}&to=${selectedLanguage}`,
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Ocp-Apim-Subscription-Key": subscriptionKey,
                    },
                    body: JSON.stringify([{ text: htmlContent }]),
                }
            );

            if (!response.ok) {
                throw new Error("Error en la solicitud de traducción");
            }

            const result = await response.json();

            // Restaura el contenido traducido a la etiqueta
            contentElement.innerHTML = result[0].translations[0].text;
            console.log("Contenido traducido:", contentElement.innerHTML);
        } catch (error) {
            console.error("Error:", error.message);
            console.error(
                "Detalles del error:",
                error.response && error.response.data
            );
        }
    }

    // Llamada a la función de traducción
    translateHTML();
</script>

<script>
    async function translateHTML() {
        const subscriptionKey = "faf48684aab84958aa0ad9bea172126a";
        const endpoint = "https://api.cognitive.microsofttranslator.com/";
        const version = "3.0";

        // Obtener el idioma seleccionado del selector
        const selectedLanguage = document.getElementById("language").value;

        console.log("Idioma seleccionado:", selectedLanguage);
        console.log("Idioma seleccionado:", selectedLanguage);

        try {
            // Obtén el contenido HTML de la etiqueta
            const contentElement = document.getElementById("translatedContent");
            const htmlContent = contentElement.innerHTML;

            // Elimina scripts y otros elementos no esenciales
            const sanitizedContent = sanitizeContent(htmlContent);

            // Asegúrate de que el contenido esté en el formato correcto
            const requestBody = [{ text: sanitizedContent }];

            const response = await fetch(
                `${endpoint}/translate?api-version=${version}&to=${selectedLanguage}`,
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Ocp-Apim-Subscription-Key": subscriptionKey,
                    },
                    body: JSON.stringify(requestBody),
                }
            );

            if (!response.ok) {
                throw new Error("Error en la solicitud de traducción");
            }

            const result = await response.json();

            // Restaura el contenido traducido a la etiqueta
            contentElement.innerHTML = result[0].translations[0].text;
            console.log("Contenido traducido:", contentElement.innerHTML);
        } catch (error) {
            console.error("Error:", error.message);
            console.error(
                "Detalles del error:",
                error.response && error.response.data
            );
        }
    }

    // Llamada a la función de traducción
    translateHTML();

    // Función para eliminar scripts y otros elementos no esenciales
    function sanitizeContent(htmlContent) {
        // Implementa la lógica para eliminar scripts u otros elementos no esenciales
        // Por ejemplo, puedes usar regex o una librería de manipulación de HTML
        // Aquí hay un ejemplo simple que elimina scripts:
        const sanitizedContent = htmlContent.replace(
            /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
            ""
        );
        return sanitizedContent;
    }
</script>
